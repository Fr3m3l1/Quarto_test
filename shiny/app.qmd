---
title: "Python Shiny App with Additional R Functionality"
format: html
runtime: shiny
execute:
  echo: true
---

```{python}
from shiny import App, ui, render
import rpy2.robjects as ro

# This function calls R code via rpy2.
def call_r_function():
    # Execute an R command and return the result.
    res = ro.r('paste("Hello from R via rpy2 in a Python Shiny app!", 456)')
    return res[0]

# Define the user interface.
app_ui = ui.page_fluid(
    ui.h2("Python Shiny App with Additional R Functionality"),
    ui.input_action_button("btn", "Call Python Function"),
    ui.output_text_verbatim("result")
)

# Define the server logic.
def server(input, output, session):
    @output
    @render.text
    def result():
        if input.btn() == 0:
            return "Click the button to run the function."
        else:
            # Call the Python function which calls R.
            return call_r_function()

# Create the Shiny app.
app = App(app_ui, server)
```

